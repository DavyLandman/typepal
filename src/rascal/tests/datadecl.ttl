test D1 [[ module A
           void main(){ D x; }
]] expect { "Undeclared type `D`" }

test D2 [[ module A
           data D;
           void main(){ D x; }
]]
test D3 [[ module A
           data D = d1();
           void main(){ D x; }
]]

test D4 [[ module A
           data D = d1();
           void main(){ D x = d1(); }
]]

test D5 [[ module A
           data D[&T] = d1(&T fld);
           void main(){ D[int] x = d1(3); }
]]

test D5 [[ module A
           data D[&T] = d1(&T fld);
           void main(){ D x = d1(3); }
]] expect { "Expected 1 type parameter for `D`" }

test D6 [[ module A
           data D[&T] = d1(&T fld);
           void main(){ D[int,str] x = d1(3); }
]] expect { "Expected 1 type parameter for `D`" }

test D7 [[ module A
           data D = d1();
           void main(){ D[&T] x = d1(); }
]] expect { "Cannot match types `D[&T]` and `D`" }

test D8 [[ module A
           data D[&T, &U] = d1(&T fld1, &U fld2);
           void main(){ D[int] x = d1(3, "a"); }
]] expect { "Expected 2 type parameters for `D`" }

test D9 [[ module A
           data D[&T] = d1(&T fld);
           module B
           import A;
           data D[&T, &U] = d1(&T fld1, &U fld2);
           void main(){ D[int] x = d1(3, "a"); }
]] expect { "Type `D` defined with 1 and 2 type parameters" }